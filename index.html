<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/a11y-dark.min.css" />
    <link rel="stylesheet" href="./style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/languages/javascript.min.js"></script>

    <script
        src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.7.0/highlightjs-line-numbers.min.js"></script>

    <script src="./dist/json-form.js"></script>

    <title>JsonForm - Demo</title>
</head>

<body>
    <header role="banner" class="container">
        <div class="row p-4">
            <div class="col-2 d-flex justify-content-center align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" version="1.1">
                    <path style="opacity:0.2"
                        d="M 14.5,8 C 13.115,8 12,9.115 12,10.5 V 55.5 C 12,56.885 13.115,58 14.5,58 H 49.5 C 50.885,58 52,56.885 52,55.5 V 23 L 37,8 Z" />
                    <path style="fill:#1c59a5"
                        d="M 14.5,7 C 13.115,7 12,8.115 12,9.5 V 54.5 C 12,55.885 13.115,57 14.5,57 H 49.5 C 50.885,57 52,55.885 52,54.5 V 22 L 37,7 Z" />
                    <path style="opacity:0.2" d="M 52,23 37,8 V 20.5 C 37,21.885 38.115,23 39.5,23 Z" />
                    <path style="fill:#6295d3" d="M 52,22 37,7 V 19.5 C 37,20.885 38.115,22 39.5,22 Z" />
                    <path style="opacity:0.1;fill:#ffffff"
                        d="M 14.5 7 C 13.115 7 12 8.115 12 9.5 L 12 10.5 C 12 9.115 13.115 8 14.5 8 L 37 8 L 37 7 L 14.5 7 z" />
                    <path style="fill:none;stroke:#000000;stroke-width:2;stroke-linecap:round;opacity:0.2"
                        d="M 37,31 C 46,34 35,38 44,41 M 37,51 C 46,48 35,44 44,41 M 27,31 C 18,34 29,38 20,41 M 27,51 C 18,48 29,44 20,41" />
                    <path style="fill:none;stroke:#ffffff;stroke-width:2;stroke-linecap:round"
                        d="M 37,30 C 46,33 35,37 44,40 M 37,50 C 46,47 35,43 44,40 M 27,30 C 18,33 29,37 20,40 M 27,50 C 18,47 29,43 20,40" />
                </svg>
            </div>

            <div class="col-10">
                <h1>JSON Form Generator</h1>
                <h3>A lightweight JavaScript library for generating forms from JSON/Object.</h3>
            </div>

        </div>

        <hr>
        <a href="https://github.com/Rmanaf/json-form"><img width="149" height="149"
                src="https://github.blog/wp-content/uploads/2008/12/forkme_left_darkblue_121621.png?resize=149%2C149"
                class="github-link attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    </header>

    <main role="main" class="container">

        <h4>Usage</h4>

        <h5>JsonForm Constructor:</h5>

        <pre>
            <code class="js">new JsonForm(data: string | object, options?: object , target?: string);</code>
        </pre>

        <h5>Data:</h5>
        <p>The <b>"data"</b> must be a JSON string or an object.</p>

        <h5>Options <sub>optional</sub></h5>
        <p>The following parameters are supported:</p>

        <ul class="opt-list">
            <li>body: <span>HTMLElement</span> , <cite>default: document.body</cite></li>
            <li>model: <span>string</span> , <cite>default: " "</cite></li>
            <li>exclude: <span>string[ ]</span> ,  <cite>default : [ ]</cite></li>
            <li>labels: <span>object</span> , <cite>default : { }</cite></li>
            <li>sections: <span>object</span> , <cite>default : { }</cite></li>
            <li>showTypes: <span>boolean</span> , <cite>default : false</cite></li>
            <li>allRequired: <span>boolean</span> , <cite>default : false</cite></li>
            <li>optionals: <span>string[ ]</span> , <cite>default : [ ]</cite></li>
            <li>types: <span>object</span> , <cite>default : { }</cite></li>
            <li>attributes: <span>object</span> , <cite>default : { }</cite></li>
            <li>encodeURI: <span>boolean</span> , <cite>default : false</cite></li>
            <li>templates: <span>object</span> , <cite>default : { }</cite></li>
            <li>meta: <span>object</span> , <cite>default : { }</cite></li>
            <li>onchange: <span>object</span> , <cite>default : { }</cite></li>
            <li>events: <span>object</span> , <cite>default : { "*" : "keyup keypress blur change", "*-number" : "keyup keypress blur change mouseup" }</cite></li>
        </ul>

        <h5>Target <sub>optional</sub></h5>
        <p>The ID of an HTML element (input or textarea).</p>

        <hr>

        <h5>Simple Form:</h5>

        <pre>
            <code class="js"> var data = {
    a : {
        b : {
            c : "d"
        }
    },
    e : {
        f : 0
    }
 }

 var editor = new JsonForm(data);</code>
        </pre>

        <h5>Result:</h5>
        <form class="row">

            <div class="col-12 col-sm-6">
                <div class="model-editor" data-model-editor data-model="usage1"></div>
            </div>

            <div class="col-12 col-sm-6">
                <textarea id="u1placeholder" readonly class="form-control" rows="6"></textarea>
            </div>

        </form>

        <hr>

        <h5>Custom Labels:</h5>

        <pre>
        <code> var editor = new JsonForm(data , {
    labels : {
        'data.a.b.c' : "Custom Label 1",
        'data.e.f' : "Custom Label 2",
    }
 });</code>
    </pre>
        <h5>Result:</h5>

        <form class="row">

            <div class="col-12">
                <div class="model-editor" data-model-editor data-model="usage2"></div>
            </div>

        </form>


        <hr>

        <h5>Exclude Fields:</h5>

        <pre>

        <code> var editor = new JsonForm(data , {
    exclude : [
        'data.e' // or 'data.e.f'
    ]
 });</code>
    </pre>

        <h5>Result:</h5>

        <form class="row">

            <div class="col-12">
                <div class="model-editor" data-model-editor data-model="usage3"></div>
            </div>

        </form>

        <hr>
        <h5>Field Attributes:</h5>

        <pre>

        <code> var editor = new JsonForm(data , {
    attributes : [
        'data.e.f' : {
            "min" : 0,
            "max" : 10,
            "class" : "form-control is-invalid"
        }
    ]
 });</code>
    </pre>

        <h5>Result:</h5>

        <form class="row">

            <div class="col-12">
                <div class="model-editor" data-model-editor data-model="usage4"></div>
            </div>

        </form>


        <hr>
        <h5>Custom Template:</h5>

        <pre>

        <code class="js"> var editor = new JsonForm(data , {
    templates : {
        'data.e.f' : 'myTemplate'
    }
 });</code>
    </pre>
    <h6>HTML Code:</h6>
    <pre>
        <code class="html">&lt;template id="myTemplate"&gt;{{label}}&lt;input type="{{inputType}}" id="{{id}}"&gt;&lt;/template&gt;</code>
    </pre>
    <div class="alert alert-info" role="alert">
        You can use, <b>id</b>, <b>inputType</b>, <b>type</b>, and <b>label</b> in the templates. To add more parameters, You can define them as metadata.
    </div>
    <pre>

        <code class="js"> var editor = new JsonForm(data , {
    meta : {
        '*' : {
            "info" : "custom value"
        }
    },
    templates : {
        '*' : 'myTemplate'
    }
 });</code>
    </pre>
    <h6>HTML Code:</h6>
    <pre>
        <code class="html">&lt;template id="myTemplate"&gt;{{label}}&lt;input type="{{inputType}}" id="{{id}}"&gt;{{info}}&lt;/template&gt;</code>
    </pre>

        <hr>

        <h5>Update Form:</h5>

        <div class="alert alert-info" role="alert">
            You can regenerate the form by calling the <b>update()</b> method.
        </div>

        <form class="row">

            <div class="col-12 col-sm-6">
                <div class="model-editor" data-model-editor data-model="usage5" ></div>
                <input class="btn btn-primary" type="button" value="Add Item" onclick="addNewEllement()">
            </div>

            
            <div class="col-12 col-sm-6">
                <textarea id="u5placeholder" readonly class="form-control" rows="6"></textarea>
            </div>

        </form>


        <!--  bootstrap-templates -->

        <template id="selectTemplate">
            <div class="form-group">
                <label for="{{id}}">Example select</label>
                <select value="0" class="form-control" id="{{id}}">
                    <option value="0">Subscriber</option>
                    <option value="1">Author</option>
                    <option value="2">Editor</option>
                    <option value="3">Contributor</option>
                </select>
            </div>
        </template>

        <template id="inputTemplate">
            <div class="from-group">
                <label for="{{id}}">{{label}}</label>
                <input id="{{id}}" class="form-control">
                <small class="form-text text-muted">{{description}}</small>
            </div>
        </template>

        <template id="checkboxTemplate">
            <div class="form-check">
                <input class="form-check-input" id="{{id}}">
                <label class="form-check-label" for="{{id}}">
                    {{label}}
                </label>
            </div>
        </template>


    </main>

    <footer role="contentinfo" class="container mb-5">


    </footer>

    <script>
        var newelemnum = 0;
        var editors = [];
        var data = {
            usage1: {
                a: {
                    b: {
                        c: "d"
                    }
                },
                e: {
                    f: 0
                }
            },
            usage2: {
                a: {
                    b: {
                        c: "d"
                    }
                },
                e: {
                    f: 0
                }
            },
            usage3: {
                a: {
                    b: {
                        c: "d"
                    }
                },
                e: {
                    f: 0
                }
            },
            usage4: {
                a: {
                    b: {
                        c: "d"
                    }
                },
                e: {
                    f: 0
                }
            },
            usage5: {
                product_0: {
                    name : "Name",
                    available : true,
                    count: 10
                }
            }
        }

        hljs.initHighlightingOnLoad();
        hljs.initLineNumbersOnLoad();

        document.addEventListener("DOMContentLoaded", function (event) {

            [...document.querySelectorAll("[data-model-editor]")].forEach((e, i) => {

                var options = {
                    body: e,
                    model: e.dataset.model,
                    labels: {
                        'data.usage2.a.b.c': "Custom Label 1",
                        'data.usage2.e.f': "Custom Label 2",
                    },
                    exclude: [
                        'data.usage3.e'
                    ],
                    templates: {
                        '*': "inputTemplate",
                        '*-checkbox': "checkboxTemplate",
                        'data.register.role': 'selectTemplate'
                    },
                    attributes: {
                        'data.usage4.e.f': {
                            "min": 0,
                            "max": 10,
                            "class": 'form-control is-invalid'
                        }
                    },
                    onchange: {
                        'data.usage1.a.b.c': u1Update,
                        'data.usage1.e.f': u1Update
                    }
                }

                var placeholder = e.dataset.placeholder;

                editors.push(new JsonForm(data, options, placeholder));

            });

            editors[4].addEventListener("update" , u5update);

        });

        function addNewEllement(){

            newelemnum++;

            data.usage5["product_" + newelemnum] = {
                name : "Name",
                available : true,
                count: 10
            }

            editors[4].update();
           
        }

        function u1Update(element, value, path, type) {
            var p = document.getElementById("u1placeholder");
            p.value = JSON.stringify(data.usage1);
        }

        function u1AddField(){
            data.usage1.e.n = "new";
            
            editors[0].set("onchange" , {
                'data.usage1.a.b.c': u1Update,
                'data.usage1.e.f': u1Update,
                'data.usage1.e.n': u1Update
            })

            editors[0].update();
        }

        function u5update(){
            var p = document.getElementById("u5placeholder");
            p.value = JSON.stringify(data.usage5);
        }

    </script>

</body>

</html>